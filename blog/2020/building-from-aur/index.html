<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Building packages from the AUR | Carlos A. Morales</title> <meta name="author" content="Carlos A. Morales"/> <meta name="description" content="A simple guide for build packages from the AUR without helpers"/> <meta name="keywords" content="cloud-solutions-architect, cloud-architect, cloud-engineer, cloud-consultant"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Serif:300,400,500,700|Roboto+Slab:300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://cmoralesmx.github.io/blog/2020/building-from-aur/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Carlos </span>A. Morales</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item"> <a class="nav-link" href="https://resume.cm-cloudarchitect.com" target="_blank" rel="noopener noreferrer">Resume </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Building packages from the AUR</h1> <p class="post-meta">December 1, 2020</p> <p class="post-tags"> <a href="/blog/2020"> <i class="fas fa-calendar fa-sm"></i> 2020 </a>   ·   <a href="/blog/tag/arch"> <i class="fas fa-hashtag fa-sm"></i> arch,</a>   <a href="/blog/tag/linux"> <i class="fas fa-hashtag fa-sm"></i> linux</a>   </p> </header> <article class="post-content"> <div class="row mt-3 mb-3"> <div class="col-sm"> <img class="img-fluid rounded z-depth-1" src="/assets/img/2020-12-01-aur.png"> </div> </div> <p>One of the interesting aspects of Arch Linux is its user-supported resources. This post will focus on one of those resources, the Arch User Repository (AUR)</p> <blockquote><p>The Arch User Repository (AUR) is a community-driven repository for Arch users. It contains package descriptions (PKGBUILDs) that allow you to compile a package from source with makepkg and then install it via pacman. The AUR was created to organize and share new packages from the community and to help expedite popular packages' inclusion into the community repository</p></blockquote> <p>Therefore, we can think of it as a massive collection of software (in source form) not available in the official repositories.</p> <p>Some may feel building these packages is hard so they recommend the use of helpers for this task, i.e.: yay, pacman, and similar. But in many cases, the build process is mostly automated by the build scripts available here.</p> <p>In my opinion, part of the reason for doing this my way is because I have set up the build tools to,</p> <ul> <li>make use of the n-cores in my system to shorten the time needed building the packages</li> <li>use RAM instead of persistent storage for the build process</li> <li>optimize the applications for a specific processor architecture</li> <li>keep the produced packages in a specific location for later reuse</li> </ul> <p>Those settings are stored in <code class="language-plaintext highlighter-rouge">~/.makepkg.conf</code> and a good guide for setting them is available at <a href="https://wiki.archlinux.org/index.php/makepkg#Tips_and_tricks" target="_blank" rel="noopener noreferrer">this entry</a> of the Arch Wiki.</p> <p>The whole process itself is fairly simple, it entails</p> <ol> <li>fetching the build package description files from the AUR</li> <li>creating the package (or packages)</li> <li>using pacman to install the produced package (or packages)</li> </ol> <p>In the next example, five packages are fetched and one gpg key is retrieved to validate one of the packages. This step is sometimes needed for some packages if the signing key of the package maintainer changed after the build file was made available.</p> <p>To fetch the build scripts we just need to git clone what we need,</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd ~/aur
$ git clone https://aur.archlinux.org/visual-studio-code-bin.git
$ git clone https://aur.archlinux.org/browsh.git
$ git clone https://aur.archlinux.org/ipscan.git
$ git clone https://aur.archlinux.org/gcc8.git
$ gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys A328C3A2C3C45C06
$ git clone https://aur.archlinux.org/cuda-10.2.git
</code></pre></div></div> <p>Cloning the needed files should be fairly fast.</p> <p>Now, each package is built in the same way by issuing the following command from each of the directories created by the clone process</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ makepkg -S
</code></pre></div></div> <p>After the build is completed, we instruct pacman to install using the packages produced by using the <code class="language-plaintext highlighter-rouge">-U</code> flag and the full path of the package,</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo pacman -U ~/aur/packages/gcc8-*.tar.zst 
$ sudo pacman -U ~/aur/packages/cuda-10.2-*.tar.zst
$ sudo pacman -U ~/aur/packages/visual-studio-code-bin-1.51.1-1-x86_64.pkg.tar.zst
</code></pre></div></div> <p>That is it, you should be ready to build your own AUR packages.</p> </article><div id="disqus_thread"></div> <script type="text/javascript">var disqus_shortname="think-code-cycle",disqus_identifier="/blog/2020/building-from-aur",disqus_title="Building packages from the AUR";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by Disqus.</a> </noscript> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2022 Carlos A. Morales. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-CW7VDPN2T7"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-CW7VDPN2T7");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>