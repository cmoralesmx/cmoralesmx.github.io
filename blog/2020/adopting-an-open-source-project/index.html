<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Carlos A. Morales | Adopting an Open Source Software project</title>
<meta name="description" content="Personal site of Carlos A. Morales, CV, Projects, Blog.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/zenburn.css" />

<!-- Styles -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/blog/2020/adopting-an-open-source-project/">

<!-- Theming-->

  <script src="/assets/js/theme.js"></script>



  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4136342-19"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-4136342-19');
  </script>


    

  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       <span class="font-weight-bold">Carlos</span> A.  Morales
      </a>
      
      <!-- Navbar Toogle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/resume/">
                resume
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Adopting an Open Source Software project</h1>
    <p class="post-meta">October 22, 2020</p>
  </header>

  <article class="post-content">
    <p>A few days ago, I needed to produce some bar plots. However, the distribution
of the data I was working with was much higher on one side of the plot while
the other had very low numbers. Plus, on the end with lower frequencies, it was
very hard to spot the differences between frequencies lower than 10.<br />
My supervisors suggested splitting the vertical axis and skipping part of the
larger bars to bring both ends of the higher and lower frequency bars closer
together. 
The suggestion made sense but I was not sure how I was going to split those
plots programmatically. Bear in mind, this was just a couple of days after
starting using R for plotting.</p>

<p>Alright, but, <em>why was I using R in the first place?</em></p>

<p>Well, a few days earlier I was happily immersed in the Python stack for all my
plotting needs. More specifically, I was using <a href="http://holoviews.org/">holoviews</a>
with the bokeh back end.
I found this solution was simplifying my analytics pipelines while making it
easy to produce interactive graphs in the Jupyter lab. All was good! Until…
My progress was stopped by a <a href="https://github.com/holoviz/holoviews/issues/3892">bug</a>
with no known solution yet. This bug crashes the plotting application whenever
an offset on the y-axis of the label is specified. Therefore, I needed to adapt.
Firstly, I tried to work around it by changing to the matplotlib back end.
The results were slightly better. At least something was being plot. Although,
the error bars and labels were failing to align with their corresponding bars.
And the plots produced looked a bit basic or dull.</p>

<div class="row mt-3 mb-3">
    <div class="col-sm-2">&nbsp;</div>
    <div class="col-sm">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/2020-11-23-adopting-oss-project-1.png" />
    </div>
    <div class="col-sm-2">&nbsp;</div>
</div>
<div class="caption">
Plotting with holoviews using the matplotlib backed with misaligned labels
and error bars.
</div>

<p>Therefore, I went searching for alternatives. I was trying to avoid getting
into the R programming language. From previous experiences, I felt this language 
a bit weird compared to what I am used to in Python. But given my current
circumstances, I gave it another try. 
A couple of the packages available were able to produce plots more closely
resembling what I needed, these were the core plotting functions and <code class="language-plaintext highlighter-rouge">ggplot2</code>
with the last requiring the least involvement for producing more visually
appealing plots than the former. The only feature missing was the splitting
of the axis.</p>

<div class="row mt-3 mb-3">
    <div class="col-sm-2">&nbsp;</div>
    <div class="col-sm">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/2020-11-23-adopting-oss-project-2.png" />
    </div>
    <div class="col-sm-2">&nbsp;</div>
</div>
<div class="caption">
A similar plot using R with ggplot2. All the elements are correctly aligned.
</div>

<p>A few hours later, I stumbled upon the <code class="language-plaintext highlighter-rouge">gg.gap</code> package which was designed for
doing this specific task on plots produced by the <code class="language-plaintext highlighter-rouge">ggplot2</code> package. I was
getting closer to solving my need. Yet again, I found a bug. The <code class="language-plaintext highlighter-rouge">gg.gap</code>
package was erroneously duplicating the subtitle and the footer of the plots
and placing them inside the split it was correctly generating in the plot
I was providing. After browsing for solutions, I found other users were
having the same problem and the authors had been quiet about the project for a
year or so.
So, because this package got me the closest to the solution, I decided to try
and solve the problem.</p>

<p>To solve the problem I needed to understand the code, but for me, it was being
a very difficult task. Yes, I was new-ish to R but the static analyser was
calculating a cyclomatic complexity of 67 for the main function. That was not
helping my case.
Eventually, I had a good grasp of the code and was confident I could solve my
problem. Yet, as I was familiarising with the code, I noticed adding features
beyond the simple fix I needed would be less daunting after some refactoring.
I decided to focus my efforts on applying Clean Code principles and following
the <a href="https://style.tidyverse.org/">tidyverse style guide</a>.</p>

<p>After a few days of work, version 1.0 was ready and it was time to make the
package available via CRAN. To do so, I followed the next three guides,</p>
<ul>
  <li><a href="https://tinyheero.github.io/jekyll/update/2015/07/26/making-your-first-R-package.html">Fong Chun Chan’s “Making Your First R Package”</a></li>
  <li><a href="http://hilaryparker.com/2014/04/29/writing-an-r-package-from-scratch/">Hilary Parker’s “Writing an R package from scratch”</a></li>
  <li><a href="http://r-pkgs.had.co.nz/">Hadley Wickham’s “R packages”</a></li>
</ul>

<p>Although I created the package manually, I found the process was not that
hard thanks to those guides. (Yet, I had to fix a few errors in the package).</p>

<p>Now, the package can be installed by issuing at the R prompt,</p>
<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"gggap"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Some examples of the package in action follow.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/2020-11-23-gggap_ex_1.png" />
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/2020-11-23-gggap_ex_2.png" />
    </div>
</div>
<div class="caption">
The original bar plot is on the left and the one produced by gggap on the right.
</div>
<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/2020-11-23-gggap_ex_3.png" />
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/2020-11-23-gggap_ex_4.png" />
    </div>
</div>
<div class="caption">
The functionality of the gggap package is not limited to bar plots. Here, we see it in action with a faceted scatter plot. The original plot is on the left and the one produced by gggap on the right.
</div>

  </article>

  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname  = 'think-code-cycle';
      var disqus_identifier = '/blog/2020/adopting-an-open-source-project';
      var disqus_title      = "Adopting an Open Source Software project";
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    &copy; Copyright 2020 Carlos A. Morales.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

    
    Last updated: December 20, 2020.
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  

  


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

<!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>


</html>
